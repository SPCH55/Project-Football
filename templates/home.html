<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ระบบจองสนามฟุตบอล</title>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body class="bg-green-100 text-center font-sans">
    
<!-- Navigation -->
<nav class="bg-green-600 py-4 flex items-center justify-between">
    <div class="flex items-center">
        <a href="{% url 'userprofile' %}" class="text-white mx-4 flex items-center">
            <i class="fas fa-user-circle text-xl"></i> <!-- Profile icon -->
        </a>
    </div>
    <div class="flex-grow text-center">
        <a href="{% url 'home' %}" class="text-white mx-4 font-bold hover:underline">หน้าหลัก</a>
        <a href="{% url 'about' %}" class="text-white mx-4 font-bold hover:underline">เกี่ยวกับสนาม</a>
        <a href="{% url 'view_bookings' %}" class="text-white mx-4 font-bold hover:underline">ดูรายการจอง</a>
        <a href="{% url 'contact' %}" class="text-white mx-4 font-bold hover:underline">ติดต่อเรา</a>
    </div>
    <div>
        <a href="{% url 'logout' %}" class="text-white mx-4 flex items-center">
            <i class="fas fa-sign-out-alt text-xl"></i> <!-- Logout icon -->
        </a>
    </div>
</nav>

<!-- Add Font Awesome CDN in the head section -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">


<!-- Add Font Awesome CDN in the head section -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">



    <div class="container mx-auto p-8">
        <h1 class="text-3xl font-bold text-green-700 mb-8">ระบบจองสนามฟุตบอล</h1>

        <!-- Fields -->
        <div class="fields flex justify-around space-x-4">
            <div class="field bg-white shadow-lg rounded-lg p-4 w-1/3">
                <img src="https://jumbokick.com/images/JPEG%201000%20x%20667%20(Save%20for%20Web)/Field-2(2).jpg" alt="สนาม 1" class="w-full rounded-lg">
                <h3 class="text-xl mt-4">สนาม 1</h3>
                <button class="bg-blue-500 text-white py-2 px-4 rounded" onclick="location.href='{% url 'book_field' %}'">จองตอนนี้</button>

                <!-- <button class="mt-4 bg-green-600 text-white py-2 px-4 rounded hover:bg-green-700" onclick="selectField('สนาม 1')">จองตอนนี้</button> -->
            </div>
            <div class="field bg-white shadow-lg rounded-lg p-4 w-1/3">
                <img src="https://jumbokick.com/images/JPEG%201000%20x%20667%20(Save%20for%20Web)/Field-2(2).jpg" alt="สนาม 2" class="w-full rounded-lg">
                <h3 class="text-xl mt-4">สนาม 2</h3>
                <button class="bg-blue-500 text-white py-2 px-4 rounded" onclick="location.href='{% url 'book_field' %}'">จองตอนนี้</button>

                <!-- <button class="mt-4 bg-green-600 text-white py-2 px-4 rounded hover:bg-green-700" onclick="selectField('สนาม 2')">จองตอนนี้</button> -->
            </div>
            <div class="field bg-white shadow-lg rounded-lg p-4 w-1/3">
                <img src="https://jumbokick.com/images/JPEG%201000%20x%20667%20(Save%20for%20Web)/Field-2(2).jpg" alt="สนาม 3" class="w-full rounded-lg">
                <h3 class="text-xl mt-4">สนาม 3</h3>
                <button class="bg-blue-500 text-white py-2 px-4 rounded" onclick="location.href='{% url 'book_field' %}'">จองตอนนี้</button>

                <!-- <button class="mt-4 bg-green-600 text-white py-2 px-4 rounded hover:bg-green-700" onclick="selectField('สนาม 3')">จองตอนนี้</button> -->
            </div>
        </div>

        <!-- Schedule -->
        <div class="schedule-container mt-10">
            <div class="schedule hidden" id="schedule">
                <div class="calendar mb-6">
                    <label for="date" class="block text-lg mb-2">เลือกวัน/เวลาที่ต้องการ:</label>
                    <input type="date" id="date" class="border border-gray-300 p-2 rounded-lg">
                </div>

                <table class="table-auto w-2/3 mx-auto border-collapse border border-gray-300">
                    <thead>
                        <tr>
                            <th class="border border-gray-500 p-2">เวลา</th>
                            <th class="border border-gray-500 p-2" id="field-name"></th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr><td class="border border-gray-500 p-2">15.00</td><td class="border border-gray-500 p-2 bg-red-500 text-white">จองแล้ว</td></tr>
                        <tr><td class="border border-gray-500 p-2">16.00</td><td class="border border-gray-500 p-2 bg-red-500 text-white">จองแล้ว</td></tr>
                        <tr><td class="border border-gray-500 p-2">17.00</td><td class="border border-gray-500 p-2 bg-green-500 cursor-pointer hover:bg-green-500" onclick="selectTime(this)">ว่าง</td></tr>
                        <tr><td class="border border-gray-500 p-2">18.00</td><td class="border border-gray-500 p-2 bg-green-500 cursor-pointer hover:bg-green-500" onclick="selectTime(this)">ว่าง</td></tr>
                        <tr><td class="border border-gray-500 p-2">19.00</td><td class="border border-gray-500 p-2 bg-red-500 text-white">จองแล้ว</td></tr>
                        <tr><td class="border border-gray-500 p-2">20.00</td><td class="border border-gray-500 p-2 bg-red-500 text-white">จองแล้ว</td></tr>
                        <tr><td class="border border-gray-500 p-2">21.00</td><td class="border border-gray-500 p-2 bg-green-500 cursor-pointer hover:bg-green-500" onclick="selectTime(this)">ว่าง</td></tr>
                        <tr><td class="border border-gray-500 p-2">22.00</td><td class="border border-gray-500 p-2 bg-green-500 cursor-pointer hover:bg-green-500" onclick="selectTime(this)">ว่าง</td></tr>
                        <tr><td class="border border-gray-500 p-2">23.00</td><td class="border border-gray-500 p-2 bg-green-500 cursor-pointer hover:bg-green-500" onclick="selectTime(this)">ว่าง</td></tr>
                    </tbody>
                </table>

                <button class="button-confirm bg-green-600 text-white py-2 px-6 rounded-lg mt-6 hover:bg-green-700" onclick="confirmBooking()">ตกลง</button>
            </div>
        </div>
    </div>

    <script>
        function selectField(fieldName) {
            document.getElementById('schedule').classList.remove('hidden');
            document.getElementById('field-name').innerText = fieldName;
        }

        function selectTime(cell) {
            // ล้างการเลือกก่อนหน้า
            let cells = document.querySelectorAll('.available');
            cells.forEach(c => c.style.backgroundColor = '#76e17a');

            // เปลี่ยนสีแสดงการเลือก
            cell.style.backgroundColor = '#4caf50';
        }

        function confirmBooking() {
            alert('การจองของคุณได้รับการยืนยันแล้ว');
        }
        
        function confirmBooking() {
    const fieldName = document.getElementById('field-name').innerText;
    const date = document.getElementById('date').value;
    const timeCell = document.querySelector('.bg-green-500'); // Get selected time cell
    const time = timeCell ? timeCell.innerText : null;

    if (time) {
        fetch("{% url 'confirm_booking' %}", {
            method: 'POST',
            headers: {
                'X-CSRFToken': '{{ csrf_token }}',
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                field_name: fieldName,
                booking_date: date,
                booking_time: time,
            })
        })
        .then(response => {
            if (response.ok) {
                alert('การจองของคุณได้รับการยืนยันแล้ว');
                window.location.reload(); // Refresh the page
            } else {
                alert('เกิดข้อผิดพลาดในการจอง');
            }
        })
        .catch(error => console.error('Error:', error));
    } 
    else {
        alert('กรุณาเลือกเวลา');
    }
}
    </script>
<input type="hidden" id="field-name" value="">
<input type="hidden" id="booking-date" value="">
<input type="hidden" id="booking-time" value="">

</body>
</html>
